(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-af8c4e94"],{"06c5":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));i("fb6a"),i("d3b7"),i("b0c0"),i("a630"),i("3ca3");var n=i("6b75");function s(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Object(n["a"])(t,e):void 0}}},"3d71":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"\n    dvs-flex dvs-flex-col dvs-items-stretch dvs-h-screen-90 dvs-overflow-hidden dvs-relative dvs-h\n  "},[i("div",{staticClass:"\n      dvs-py-2\n      dvs-px-8\n      dvs-rounded-tl\n      dvs-rounded-tr\n      dvs-flex\n      dvs-justify-between\n      dvs-items-center\n      dvs-bg-gray-300\n      dvs-border-b\n      dvs-border-lighter\n      dvs-relative\n    "},[t._v(" Media Editor "),i("div",[i("button",{staticClass:"dvs-btn dvs-btn-primary dvs-btn-sm dvs-mr-2",on:{click:t.done}},[t._v("Done")]),i("button",{staticClass:"dvs-btn dvs-btn-ghost dvs-btn-sm",on:{click:t.cancel}},[t._v("Cancel")])])]),t.activeImage?i("div",{staticClass:"dvs-flex dvs-items-stretch"},[i("media-thumbnails",{attrs:{"default-image":t.defaultImage,"size-edits":t.sizeEdits,sizes:t.sizes,"encode-edits":t.encodeEdits,active:t.active,warning:t.showWarning},on:{select:t.setActive}}),i("vue-scrollbar",{staticClass:"dvs-flex-grow",staticStyle:{height:"80vh"}},[i("div",{staticClass:"dvs-relative"},[t.sizeEdits[t.activeImage.name]?i("media-controls",{attrs:{"active-image":t.activeImage},on:{settooriginal:t.setCustomSizeToOriginal,selectsizeimage:t.selectSizeImage},model:{value:t.sizeEdits[t.activeImage.name],callback:function(e){t.$set(t.sizeEdits,t.activeImage.name,e)},expression:"sizeEdits[activeImage.name]"}}):t._e(),t.sizeEdits[t.active]?i("media-editor-preview",{attrs:{sizes:t.sizes,"custom-size":{w:t.sizeEdits[t.active].w,h:t.sizeEdits[t.active].h},active:t.active,"active-image":t.activeImage,"encode-edits":t.encodeEdits,warning:t.showWarning},on:{applycrop:t.applyCrop,removecrop:t.removeCrop}}):t._e()],1)])],1):t._e()])},s=[];function a(t){if(Array.isArray(t))return t}i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0");function r(t,e){var i=t&&("undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=i){var n,s,a=[],r=!0,c=!1;try{for(i=i.call(t);!(r=(n=i.next()).done);r=!0)if(a.push(n.value),e&&a.length===e)break}catch(o){c=!0,s=o}finally{try{r||null==i["return"]||i["return"]()}finally{if(c)throw s}}return a}}var c=i("06c5");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t,e){return a(t)||r(t,e)||Object(c["a"])(t,e)||o()}var l=i("5530"),u=(i("99af"),i("b64b"),i("159b"),i("4fad"),i("b0c0"),i("2f62")),h={name:"DeviseMediaEditor",components:{MediaControls:function(){return Promise.all([i.e("chunk-ea03fefc"),i.e("chunk-2d0c13e6")]).then(i.bind(null,"44e5"))},MediaThumbnails:function(){return i.e("chunk-2d0af85b").then(i.bind(null,"0f4c"))},MediaEditorPreview:function(){return i.e("chunk-412686ca").then(i.bind(null,"3b56"))},VueScrollbar:function(){return i.e("chunk-2d0a310b").then(i.t.bind(null,"011e",7))}},props:{defaultImage:{type:String,required:!0},sizes:{type:Object,default:null},imageSettings:{type:Object,default:null}},data:function(){return{active:"original",defaultEdits:{q:70,or:null,flip:null,fit:"crop",bri:null,con:null,gam:null,sharp:5,pixel:null,filt:null,bg:null,url:null,crop:null,w:null,h:null,originalw:null,originalh:null},sizeEdits:{}}},computed:{activeImage:function(){return this.active&&"undefined"!==typeof this.sizeEdits&&this.sizeEdits[this.active]?{url:"/styled/preview/".concat(this.sizeEdits[this.active].url,"?").concat(this.encodeEdits(this.active)),baseImageUrl:"/styled/preview/".concat(this.sizeEdits[this.active].url),name:"".concat(this.active),sizeLabel:"(".concat(this.sizeEdits[this.active].w,"x").concat(this.sizeEdits[this.active].h,")")}:{url:"/styled/preview/".concat(this.defaultImage),name:"Original"}},showWarning:function(){return!(!this.sizeEdits[this.active]||null!==this.sizeEdits[this.active].fit&&this.sizeEdits[this.active].originalw===this.sizeEdits[this.active].w&&this.sizeEdits[this.active].originalh===this.sizeEdits[this.active].h)}},mounted:function(){this.setInitialActive(),this.loadImageSettings()},methods:Object(l["a"])(Object(l["a"])({},Object(u["b"])("devise",["generateImages"])),{},{done:function(){var t=this;this.generateAndSaveImages().then((function(){t.$emit("done")}))},cancel:function(){this.$emit("cancel")},setActive:function(t){this.active=t},setInitialActive:function(){if(this.sizes){var t=Object.keys(this.sizes)[0];return this.setActive(t),!0}return this.setActive("custom"),!1},getOriginalDimentions:function(){var t=this,e="/styled/preview/".concat(this.defaultImage),i=new Image;return i.onerror=function(){alert("not a valid file: ".concat(e.type))},i.src=e,new Promise((function(e){i.onload=function(){t.$nextTick((function(){e(i)}))}}))},setCustomSizeToOriginal:function(){var t=this.sizeEdits[this.active];t.w=t.originalw,t.h=t.originalh},clean:function(t){for(var e in t)null===t[e]||void 0===t[e]?delete t[e]:"bg"===e&&(t[e]=t[e].substring(1));return t},setImage:function(t){this.sizeEdits[this.active].url=t.url},generateAndSaveImages:function(){var t=this;return new Promise((function(){window.deviseSettings.$bus.$emit("showLoadScreen","Images being generated"),t.generateImages({defaultImage:t.defaultImage,sizes:t.sizeEdits}).then((function(e){return t.$emit("generatedImages",{images:e.data,settings:t.sizeEdits}),!0})).then((function(){window.deviseSettings.$bus.$emit("hideLoadScreen")}),(function(){window.deviseSettings.$bus.$emit("hideLoadScreen")}))}))},loadImageSettings:function(){var t=this;this.sizes?Object.entries(this.sizes).forEach((function(e){var i=d(e,2),n=i[0],s=i[1];"custom"!==n&&t.createSizeEdit(n,s)})):this.createSizeEdit("custom")},createSizeEdit:function(t,e){var i=this;this.$set(this.sizeEdits,t,{}),this.sizeEdits[t]=Object.assign({},this.defaultEdits,this.imageSettings[t]),this.sizeEdits[t].url||(this.sizeEdits[t].url=this.defaultImage),e?(null!==this.sizeEdits[t].w&&null!==!this.sizeEdits[t].h||(this.sizeEdits[t].w=e.w,this.sizeEdits[t].h=e.h),this.sizeEdits[t].originalw=e.w,this.sizeEdits[t].originalh=e.h):null!==this.sizeEdits[t].w&&null!==!this.sizeEdits[t].h||this.getOriginalDimentions().then((function(e){i.sizeEdits[t].w=e.width,i.sizeEdits[t].h=e.height,i.sizeEdits[t].originalw=e.width,i.sizeEdits[t].originalh=e.height}))},selectSizeImage:function(){this.$emit("selectsizeimage",this.active)},applyCrop:function(t){this.$set(this.sizeEdits[this.activeImage.name],"crop",{w:t.width,h:t.height,x:t.x,y:t.y})},removeCrop:function(){this.$set(this.sizeEdits[this.activeImage.name],"crop",null)},encodeEdits:function(t){var e="";for(var i in this.sizeEdits[t])if(null!==this.sizeEdits[t][i]){""!==e&&(e+="&");var n=this.sizeEdits[t][i];"bg"===i&&(n=n.substring(1)),"crop"===i&&(n="".concat(n.w,",").concat(n.h,",").concat(n.x,",").concat(n.y)),e+="".concat(i,"=").concat(n)}return e}})},v=h,f=i("2877"),g=Object(f["a"])(v,n,s,!1,null,null,null);e["default"]=g.exports},"4df4":function(t,e,i){"use strict";var n=i("0366"),s=i("7b0b"),a=i("9bdd"),r=i("e95a"),c=i("50c4"),o=i("8418"),d=i("35a1");t.exports=function(t){var e,i,l,u,h,v,f=s(t),g="function"==typeof this?this:Array,m=arguments.length,b=m>1?arguments[1]:void 0,z=void 0!==b,E=d(f),w=0;if(z&&(b=n(b,m>2?arguments[2]:void 0,2)),void 0==E||g==Array&&r(E))for(e=c(f.length),i=new g(e);e>w;w++)v=z?b(f[w],w):f[w],o(i,w,v);else for(u=E.call(f),h=u.next,i=new g;!(l=h.call(u)).done;w++)v=z?a(u,b,[l.value,w],!0):l.value,o(i,w,v);return i.length=w,i}},"4fad":function(t,e,i){var n=i("23e7"),s=i("6f53").entries;n({target:"Object",stat:!0},{entries:function(t){return s(t)}})},"6b75":function(t,e,i){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}i.d(e,"a",(function(){return n}))},"6f53":function(t,e,i){var n=i("83ab"),s=i("df75"),a=i("fc6a"),r=i("d1e7").f,c=function(t){return function(e){var i,c=a(e),o=s(c),d=o.length,l=0,u=[];while(d>l)i=o[l++],n&&!r.call(c,i)||u.push(t?[i,c[i]]:c[i]);return u}};t.exports={entries:c(!0),values:c(!1)}},"9bdd":function(t,e,i){var n=i("825a"),s=i("2a62");t.exports=function(t,e,i,a){try{return a?e(n(i)[0],i[1]):e(i)}catch(r){throw s(t),r}}},a630:function(t,e,i){var n=i("23e7"),s=i("4df4"),a=i("1c7e"),r=!a((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:r},{from:s})}}]);
//# sourceMappingURL=chunk-af8c4e94.6c1e6a30.js.map